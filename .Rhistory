# sander
sanders_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state" == states)]
sanders_state = aggregate(data = subset(sanders_state,contributor_state == states),
contribution_receipt_amount ~ contributor_state,
FUN = sum)
sanders_state = sanders_state[sanders_state$contribution_receipt_amount == states, ]
sanders_state = aggregate(data = sanders_state,
contribution_receipt_amount ~ contributor_state,
FUN = sum)
View(sanders_state)
sanders_state = sanders_state[sanders_state$contribution_receipt_amount %in% states, ]
# correlation between fund and polls
states = c("IA","NH","NV","SC","AL","AR","CA","CO","ME","MA","MN","NC","OK","TN","TX","UT","VT","VA")
# sander
sanders_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state")]
sanders_state = sanders_state[sanders_state$contribution_receipt_amount %in% states, ]
View(sanders_state)
# sander
sanders_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state")]
View(sanders_state)
sanders_state = sanders_state[sanders_state$contributor_state %in% states, ]
View(sanders_state)
# sander
sanders_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state")]
#sanders_state = sanders_state[sanders_state$contributor_state %in% states, ]
sanders_state = aggregate(data = sanders_state[sanders_state$contributor_state %in% states, ],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
View(sanders_state)
poll_result = read.csv("./dat/funding/result.csv", header = TRUE)
View(poll_result)
sanders_state_poll_count = poll_result[Candidate == "Sanders",]
sanders_state_poll_count = poll_result[poll_result$Candidate == "Sanders",]
View(sanders_state_poll_count)
sanders_state_poll_count = sanders_state_poll_count[,c("State","Count")]
View(sanders_state_poll_count)
View(sanders_data_state)
# sander
sanders_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state")]
sanders_state_fund = aggregate(data = sanders_state[sanders_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
View(sanders_state_fund)
sanders_amount = sanders_state_fund %>% right_join(sanders_state_poll_count,
by=c("contributor_states","State"))
library(ggplot2)
library(dplyr)
library(plyr)
sanders_amount = sanders_state_fund %>% right_join(sanders_state_poll_count,
by=c("contributor_states","State"))
sanders_amount = merge(x=sanders_state_fund, y=sanders_state_poll_count,
by.x="contributor_state", by.y="State")
View(sanders_amount)
sanders_amount = sanders_amount[,c("contribution_receipt_amount","Count")]
ggplot(sanders_amount, aes(x=contribution_receipt_amount, y=Count)) + geom_point()
candidate_state_fund = aggregate(data = candidate_state[candidate_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
# biden
summary_amount = function(candidate){
candidate_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state")]
candidate_state_fund = aggregate(data = candidate_state[candidate_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
candidate_state_poll_count = poll_result[poll_result$Candidate == candidate,]
candidate_state_poll_count = candidate_state_poll_count[,c("State","Count")]
candidate_amount = merge(x=candidate_state_fund, y=candidate_state_poll_count,
by.x="contributor_state", by.y="State")
candidate_amount = candidate_amount[,c("contribution_receipt_amount","Count")]
ggplot(candidate_amount, aes(x=contribution_receipt_amount, y=Count)) + geom_point()
}
# biden
biden_state = fund_biden_use[,c("contribution_receipt_amount","contributor_state")]
biden_state_fund = aggregate(data = biden_state[biden_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
biden_state_poll_count = poll_result[poll_result$Candidate == "Biden",]
biden_state_poll_count = biden_state_poll_count[,c("State","Count")]
biden_amount = merge(x=biden_state_fund, y=biden_state_poll_count,
by.x="contributor_state", by.y="State")
biden_amount = biden_amount[,c("contribution_receipt_amount","Count")]
ggplot(biden_amount, aes(x=contribution_receipt_amount, y=Count)) + geom_point()
ggplot(sanders_amount, aes(x=contribution_receipt_amount, y=Count)) + geom_point()
amount_all = bind_rows(sanders_amount,biden_amount)
View(amount_all)
sanders_amount = sanders_amount[,c("contribution_receipt_amount","Count")]
name = rep("Sanders",length(sanders_amount))
sanders_amount = cbind(sanders_amount, name)
View(sanders_amount)
name = rep("Biden",length(sanders_amount))
biden_amount = cbind(biden_amount, name)
View(biden_amount)
amount_all = bind_rows(sanders_amount,biden_amount)
View(amount_all)
ggplot(biden_amount, aes(x=contribution_receipt_amount, y=Count, shape=name)) + geom_point()
amount_all = bind_rows(sanders_amount,biden_amount)
amount_all = bind_rows(sanders_amount,biden_amount)
View(biden_amount)
View(sanders_amount)
sapply(biden_amount, class)
sapply(sanders_amount, class)
# sander
sanders_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state")]
sanders_state_fund = aggregate(data = sanders_state[sanders_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
sanders_state_poll_count = poll_result[poll_result$Candidate == "Sanders",]
sanders_state_poll_count = sanders_state_poll_count[,c("State","Count")]
sanders_amount = merge(x=sanders_state_fund, y=sanders_state_poll_count,
by.x="contributor_state", by.y="State")
sanders_amount = sanders_amount[,c("contribution_receipt_amount","Count")]
dancidate_name = rep("Sanders",length(sanders_amount))
# correlation between fund and polls
states = c("IA","NH","NV","SC","AL","AR","CA","CO","ME","MA","MN","NC","OK","TN","TX","UT","VT","VA")
# sander
sanders_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state")]
sanders_state_fund = aggregate(data = sanders_state[sanders_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
sanders_state_poll_count = poll_result[poll_result$Candidate == "Sanders",]
sanders_state_poll_count = sanders_state_poll_count[,c("State","Count")]
sanders_amount = merge(x=sanders_state_fund, y=sanders_state_poll_count,
by.x="contributor_state", by.y="State")
sanders_amount = sanders_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Sanders",length(sanders_amount))
sanders_amount = cbind(sanders_amount, name)
# biden
biden_state = fund_biden_use[,c("contribution_receipt_amount","contributor_state")]
biden_state_fund = aggregate(data = biden_state[biden_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
biden_state_poll_count = poll_result[poll_result$Candidate == "Biden",]
biden_state_poll_count = biden_state_poll_count[,c("State","Count")]
biden_amount = merge(x=biden_state_fund, y=biden_state_poll_count,
by.x="contributor_state", by.y="State")
biden_amount = biden_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Biden",length(sanders_amount))
biden_amount = cbind(biden_amount, name)
candidate_name = rep("Sanders",length(sanders_amount))
sanders_amount = cbind(sanders_amount, candidate_name)
candidate_name = rep("Biden",length(sanders_amount))
biden_amount = cbind(biden_amount, candidate_name)
# sander
sanders_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state")]
sanders_state_fund = aggregate(data = sanders_state[sanders_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
sanders_state_poll_count = poll_result[poll_result$Candidate == "Sanders",]
sanders_state_poll_count = sanders_state_poll_count[,c("State","Count")]
sanders_amount = merge(x=sanders_state_fund, y=sanders_state_poll_count,
by.x="contributor_state", by.y="State")
sanders_amount = sanders_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Sanders",length(sanders_amount))
sanders_amount = cbind(sanders_amount, candidate_name)
# biden
biden_state = fund_biden_use[,c("contribution_receipt_amount","contributor_state")]
biden_state_fund = aggregate(data = biden_state[biden_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
biden_state_poll_count = poll_result[poll_result$Candidate == "Biden",]
biden_state_poll_count = biden_state_poll_count[,c("State","Count")]
biden_amount = merge(x=biden_state_fund, y=biden_state_poll_count,
by.x="contributor_state", by.y="State")
biden_amount = biden_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Biden",length(biden_amount))
biden_amount = cbind(biden_amount, candidate_name)
amount_all = bind_rows(sanders_amount,biden_amount)
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count, shape=name)) + geom_point()
amount_all = bind_rows(sanders_amount,biden_amount)
amount_all = bind_rows(sanders_amount,biden_amount)
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count, shape=candidate_name)) + geom_point()
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count,
shape=candidate_name, color=candidate_name)) + geom_point()
# bloomberg
bloomberg_state = fund_bloomberg_use[,c("contribution_receipt_amount","contributor_state")]
bloomberg_state_fund = aggregate(data = bloomberg_state[bloomberg_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
bloomberg_state_poll_count = poll_result[poll_result$Candidate == "Bloomberg",]
bloomberg_state_poll_count = bloomberg_state_poll_count[,c("State","Count")]
bloomberg_amount = merge(x=bloomberg_state_fund, y=bloomberg_state_poll_count,
by.x="contributor_state", by.y="State")
bloomberg_amount = biden_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Bloomberg",length(bloomberg_amount))
bloomberg_amount = cbind(bloomberg_amount, candidate_name)
amount_all = bind_rows(sanders_amount,biden_amount,bloomberg_amount)
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count,
shape=candidate_name, color=candidate_name)) + geom_point()
# bloomberg
bloomberg_state = fund_bloomberg_use[,c("contribution_receipt_amount","contributor_state")]
bloomberg_state_fund = aggregate(data = bloomberg_state[bloomberg_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
bloomberg_state_poll_count = poll_result[poll_result$Candidate == "Bloomberg",]
bloomberg_state_poll_count = bloomberg_state_poll_count[,c("State","Count")]
bloomberg_amount = merge(x=bloomberg_state_fund, y=bloomberg_state_poll_count,
by.x="contributor_state", by.y="State")
bloomberg_amount = bloomberg_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Bloomberg",length(bloomberg_amount))
bloomberg_amount = cbind(bloomberg_amount, candidate_name)
# warren
warren_state = fund_warren_use[,c("contribution_receipt_amount","contributor_state")]
warren_state_fund = aggregate(data = warren_state[warren_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
warren_state_poll_count = poll_result[poll_result$Candidate == "Warren",]
warren_state_poll_count = warren_state_poll_count[,c("State","Count")]
warren_amount = merge(x=warren_state_fund, y=warren_state_poll_count,
by.x="contributor_state", by.y="State")
warren_amount = warren_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Warren",length(warren_amount))
warren_amount = cbind(warren_amount, candidate_name)
amount_all = bind_rows(sanders_amount,biden_amount,bloomberg_amount,warren_amount)
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count,
shape=candidate_name, color=candidate_name)) + geom_point()
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count,
shape=candidate_name, color=candidate_name)) +
geom_point() + scale_y_sqrt() + scale_x_sqrt()
# buttigieg
buttigieg_state = fund_buttigieg_use[,c("contribution_receipt_amount","contributor_state")]
buttigieg_state_fund = aggregate(data = buttigieg_state[buttigieg_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
buttigieg_state_poll_count = poll_result[poll_result$Candidate == "Buttigieg",]
buttigieg_state_poll_count = buttigieg_state_poll_count[,c("State","Count")]
buttigieg_amount = merge(x=buttigieg_state_fund, y=buttigieg_state_poll_count,
by.x="contributor_state", by.y="State")
buttigieg_amount = buttigieg_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Buttigieg",length(buttigieg_amount))
buttigieg_amount = cbind(buttigieg_amount, candidate_name)
amount_all = bind_rows(sanders_amount,biden_amount,buttigieg_amount,warren_amount)
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count,
shape=candidate_name, color=candidate_name)) +
geom_point() + scale_y_sqrt() + scale_x_sqrt()
# klobuchar
klobuchar_state = fund_klobuchar_use[,c("contribution_receipt_amount","contributor_state")]
klobuchar_state_fund = aggregate(data = klobuchar_state[klobuchar_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
klobuchar_state_poll_count = poll_result[poll_result$Candidate == "Klobuchar",]
klobuchar_state_poll_count = klobuchar_state_poll_count[,c("State","Count")]
klobuchar_amount = merge(x=klobuchar_state_fund, y=klobuchar_state_poll_count,
by.x="contributor_state", by.y="State")
klobuchar_amount = klobuchar_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Klobuchar",length(klobuchar_amount))
klobuchar_amount = cbind(klobuchar_amount, candidate_name)
amount_all = bind_rows(sanders_amount,biden_amount,buttigieg_amount,warren_amount,klobuchar_amount)
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count,
shape=candidate_name, color=candidate_name)) +
geom_point() + scale_y_sqrt() + scale_x_sqrt()
# sander
sanders_state = fund_sanders_use[,c("contribution_receipt_amount","contributor_state")]
sanders_state_fund = aggregate(data = sanders_state[sanders_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
sanders_state_poll_count = poll_result[poll_result$Candidate == "Sanders",]
sanders_state_poll_count = sanders_state_poll_count[,c("State","Count")]
sanders_amount = merge(x=sanders_state_fund, y=sanders_state_poll_count,
by.x="contributor_state", by.y="State")
sanders_amount = sanders_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Sanders",length(sanders_amount))
sanders_amount_wn = cbind(sanders_amount, candidate_name)
# biden
biden_state = fund_biden_use[,c("contribution_receipt_amount","contributor_state")]
biden_state_fund = aggregate(data = biden_state[biden_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
biden_state_poll_count = poll_result[poll_result$Candidate == "Biden",]
biden_state_poll_count = biden_state_poll_count[,c("State","Count")]
biden_amount = merge(x=biden_state_fund, y=biden_state_poll_count,
by.x="contributor_state", by.y="State")
biden_amount = biden_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Biden",length(biden_amount))
biden_amount_wn = cbind(biden_amount, candidate_name)
# buttigieg
buttigieg_state = fund_buttigieg_use[,c("contribution_receipt_amount","contributor_state")]
buttigieg_state_fund = aggregate(data = buttigieg_state[buttigieg_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
buttigieg_state_poll_count = poll_result[poll_result$Candidate == "Buttigieg",]
buttigieg_state_poll_count = buttigieg_state_poll_count[,c("State","Count")]
buttigieg_amount = merge(x=buttigieg_state_fund, y=buttigieg_state_poll_count,
by.x="contributor_state", by.y="State")
buttigieg_amount = buttigieg_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Buttigieg",length(buttigieg_amount))
buttigieg_amount_wn = cbind(buttigieg_amount, candidate_name)
# warren
warren_state = fund_warren_use[,c("contribution_receipt_amount","contributor_state")]
warren_state_fund = aggregate(data = warren_state[warren_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
warren_state_poll_count = poll_result[poll_result$Candidate == "Warren",]
warren_state_poll_count = warren_state_poll_count[,c("State","Count")]
warren_amount = merge(x=warren_state_fund, y=warren_state_poll_count,
by.x="contributor_state", by.y="State")
warren_amount = warren_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Warren",length(warren_amount))
warren_amount_wn = cbind(warren_amount, candidate_name)
# klobuchar
klobuchar_state = fund_klobuchar_use[,c("contribution_receipt_amount","contributor_state")]
klobuchar_state_fund = aggregate(data = klobuchar_state[klobuchar_state$contributor_state %in% states,],
contribution_receipt_amount ~ contributor_state,
FUN = sum)
klobuchar_state_poll_count = poll_result[poll_result$Candidate == "Klobuchar",]
klobuchar_state_poll_count = klobuchar_state_poll_count[,c("State","Count")]
klobuchar_amount = merge(x=klobuchar_state_fund, y=klobuchar_state_poll_count,
by.x="contributor_state", by.y="State")
klobuchar_amount = klobuchar_amount[,c("contribution_receipt_amount","Count")]
candidate_name = rep("Klobuchar",length(klobuchar_amount))
klobuchar_amount_wn = cbind(klobuchar_amount, candidate_name)
amount_all = bind_rows(sanders_amount_wn,biden_amount_wn,buttigieg_amount_wn,
warren_amount_wn,klobuchar_amount_wn)
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count,
shape=candidate_name, color=candidate_name)) +
geom_point() + scale_y_sqrt() + scale_x_sqrt()
# correlation between fund percentage and poll percentage
biden_model = lm(Count ~ poly(contribution_receipt_amount,3))
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,3))
summary(biden_model)
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,2))
summary(biden_model)
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,1))
summary(biden_model)
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,4))
summary(biden_model)
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,3))
summary(biden_model)
ggplot(p + stat_smooth(method="lm", se=TRUE, fill=NA,
formula=biden_model$biden_amount ~ poly(biden$contribution_receipt_amount, 3, raw=TRUE),colour="red"))
ggplot(stat_smooth(method="lm", se=TRUE, fill=NA,
formula=biden_model$biden_amount ~ poly(biden$contribution_receipt_amount, 3, raw=TRUE),colour="red"))
View(biden_model)
ggplot(biden_model)
#summary(biden_model)
#ggplot(stat_smooth(method="lm", se=TRUE, fill=NA,
#               formula=biden_model$biden_amount ~ poly(biden$contribution_receipt_amount, 3, raw=TRUE),colour="red"))
ggplot(biden_model)
plot(biden_amount ~ contribution_receipt_amount, data = biden_model)
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,3))
plot(biden_amount ~ contribution_receipt_amount, data = biden_model)
View(biden_model)
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,3))
plot(biden_amount ~ contribution_receipt_amount, data = biden_amount)
abline(biden_model)
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,3))
ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() + stat_smooth(method = "lm", col = "red")
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,3))
summary(biden_model)
biden_model = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,3))
summary(biden_model)
ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = Count ~ poly(contribution_receipt_amount, 3), size = 1)
ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1)
ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1) +
scale_y_sqrt() + scale_x_sqrt()
amount_all = bind_rows(sanders_amount_wn,biden_amount_wn,buttigieg_amount_wn,
warren_amount_wn,klobuchar_amount_wn)
ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count,
shape=candidate_name, color=candidate_name)) +
geom_point() + scale_y_sqrt() + scale_x_sqrt()
amount_all_plot = ggplot(amount_all, aes(x=contribution_receipt_amount, y=Count,
shape=candidate_name, color=candidate_name)) +
geom_point() + scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Funding and poll count",
x = "funding($million)", y = "Poll Count")
amount_all_plot
ggsave("./out/fund/amount_all.jpg", amount_all_plot)
biden_fit = lm(data = biden_amount,Count ~ poly(contribution_receipt_amount,3))
summary(biden_fit)
biden_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 3)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Biden's Funding",
x = "", y = "Fund Raised ($million)")
ggsave("./out/fund/biden_fit.jpg", biden_fit_plot)
biden_fit_plot
biden_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 1)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Biden's Funding",
x = "", y = "Fund Raised ($million)")
biden_fit_plot
biden_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 2)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Biden's Funding",
x = "", y = "Fund Raised ($million)")
biden_fit_plot
biden_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 3)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Biden's Funding",
x = "", y = "Fund Raised ($million)")
biden_fit_plot
ggsave("./out/fund/biden_fit.jpg", biden_fit_plot)
sanders_fit = lm(data = sanders_amount,Count ~ poly(contribution_receipt_amount,3))
summary(sanders_fit)
sanders_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 3)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Sanders's Funding",
x = "", y = "Fund Raised ($million)")
sanders_fit_plot
sanders_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 2)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Sanders's Funding",
x = "", y = "Fund Raised ($million)")
sanders_fit_plot
sanders_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 4)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Sanders's Funding",
x = "", y = "Fund Raised ($million)")
sanders_fit_plot
sanders_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 3)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Sanders's Funding",
x = "", y = "Fund Raised ($million)")
sanders_fit_plot
sanders_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ poly(x, 1)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Sanders's Funding",
x = "", y = "Fund Raised ($million)")
sanders_fit_plot
biden_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
#stat_smooth(method = "lm", formula = y ~ poly(x, 3)) +
stat_smooth(method = "lm", formula = y ~ log(x)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Biden's Funding",
x = "", y = "Fund Raised ($million)")
biden_fit_plot
# polynomial fitting
biden_fit = lm(data = biden_amount,Count ~ log(contribution_receipt_amount,3))
summary(biden_fit)
biden_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ log(x,3)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Biden's Funding",
x = "", y = "Fund Raised ($million)")
biden_fit_plot
# polynomial fitting
biden_fit = lm(data = biden_amount,Count ~ log(contribution_receipt_amount))
summary(biden_fit)
biden_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ log(x,3)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Biden's Funding",
x = "", y = "Fund Raised ($million)")
biden_fit_plot
sanders_fit = lm(data = sanders_amount,Count ~ log(contribution_receipt_amount))
summary(sanders_fit)
sanders_fit_plot = ggplot(data = biden_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ log(x)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Sanders's Funding",
x = "", y = "Fund Raised ($million)")
sanders_fit_plot
ggsave("./out/fund/sanders_fit.jpg", sanders_fit_plot)
warren_fit = lm(data = warren_amount,Count ~ log(contribution_receipt_amount))
warren_fit = lm(data = warren_amount,Count ~ log(contribution_receipt_amount))
summary(warren_fit)
warren_fit_plot = ggplot(data = warren_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ log(x)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Warren's Funding",
x = "", y = "Fund Raised ($million)")
warren_fit_plot
ggsave("./out/fund/warren_fit.jpg", warren_fit_plot)
summary(sanders_fit)
klobuchar_fit = lm(data = klobuchar_amount,Count ~ log(contribution_receipt_amount))
summary(klobuchar_fit)
klobuchar_fit_plot = ggplot(data = klobuchar_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ log(x)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Klobuchar's Funding",
x = "", y = "Fund Raised ($million)")
klobuchar_fit_plot
ggsave("./out/fund/klobuchar_fit.jpg", klobuchar_fit_plot)
buttigieg_fit = lm(data = buttigieg_amount,Count ~ log(contribution_receipt_amount))
summary(klobuchar_fit)
buttigieg_fit_plot = ggplot(data = buttigieg_amount, aes(x = contribution_receipt_amount, y = Count)) +
geom_point() +
stat_smooth(method = "lm", formula = y ~ log(x)) +
scale_y_sqrt() + scale_x_sqrt() +
labs(title = "Buttigieg's Funding",
x = "", y = "Fund Raised ($million)")
buttigieg_fit_plot
ggsave("./out/fund/buttigieg_fit.jpg", buttigieg_fit_plot)
